<h2>Shopping Cart</h2>

<app-data-state
  [loading]="cartResource.loading()"
  [error]="cartResource.error()"
  [hasData]="cartResource.hasData()"
  loadingMessage="Loading your cartâ€¦"
  emptyMessage="Your cart is empty"
  errorTitle="Could not load cart."
  (retry)="reload()"
/>

@if (cartResource.data(); as cartData) {
  <div class="cart-summary">
    <p>Total Items: {{ cartData.items.length }}</p>
    <p>Subtotal: {{ cartData.currency }} {{ cartData.subtotal.toFixed(2) }}</p>
    <p>Total: {{ cartData.currency }} {{ cartData.total.toFixed(2) }}</p>
  </div>

  @if (cartData.items.length > 0) {
    <div class="cart-items">
      @for (item of cartData.items; track item.productId) {
        <div class="cart-item">
          <img [src]="item.imageUrl" [alt]="item.productName" />
          <div class="item-details">
            <h3>{{ item.productName }}</h3>
            <p>Quantity: {{ item.quantity }}</p>
            <p>Unit Price: {{ cartData.currency }} {{ item.unitPrice.toFixed(2) }}</p>
            <p class="line-total">Total: {{ cartData.currency }} {{ item.lineTotal.toFixed(2) }}</p>
          </div>
        </div>
      }
    </div>
  }
}
