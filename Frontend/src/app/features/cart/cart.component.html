<div class="cart-container">
  <h1>Shopping Cart</h1>

  <app-data-state
    [loading]="loading()"
    [error]="error()"
    [hasData]="cart() !== null"
    loadingMessage="Loading your cartâ€¦"
    emptyMessage="Your cart is empty"
    errorTitle="Could not load cart."
    (retry)="reload()"
  />

  @if (cart(); as cartData) {
    @if (!isEmpty()) {
      <app-sidebar-layout>
        <div main class="cart-content">
          <div class="cart-items">
            @for (item of cartData.items; track item.productId) {
              <app-cart-item
                [item]="item"
                [currency]="cartData.currency"
                (quantityChange)="updateQuantity(item.productId, $event)"
                (remove)="removeItem(item.productId)"
              />
            }
          </div>

          <div class="cart-actions-mobile">
            <app-button (click)="clearCart()">Clear Cart</app-button>
          </div>
        </div>
        <div sidebar>
          <app-order-summary-panel
            [cart]="cart()"
            [showItemDetails]="false"
            ctaLabel="Proceed to Checkout"
            [showSecondaryCta]="true"
            secondaryCtaLabel="Clear Cart"
            (ctaClick)="checkout()"
            (secondaryCtaClick)="clearCart()"
          />
        </div>
      </app-sidebar-layout>
    }
  }
</div>
