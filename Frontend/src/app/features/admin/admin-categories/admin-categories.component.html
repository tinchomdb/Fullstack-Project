<div class="admin-categories">
  <div class="categories-header">
    <h2>Categories Management</h2>
    <app-button (click)="openCreateForm()" shape="rounded">Add New Category</app-button>
  </div>

  @if (showForm()) {
    <app-modal-form
      [title]="editingCategory() ? 'Edit Category' : 'Create New Category'"
      [maxWidth]="'500px'"
      (close)="closeForm()"
    >
      <app-admin-category-form
        [editingCategory]="editingCategory()"
        [availableParentCategories]="getAvailableParentCategories()"
        [loading]="loading()"
        (save)="saveCategory($event)"
        (cancel)="closeForm()"
      />
    </app-modal-form>
  }

  <div class="categories-tree">
    @if (categories().length === 0 && !loading()) {
      <app-empty-state
        icon="folder"
        heading="No categories found"
        description="Create your first category to organize products."
        ctaLabel="Add Category"
        [ctaAction]="openCreateForm.bind(this)"
      />
    }

    @for (node of categoryTree(); track node.category.id) {
      <app-admin-category-tree-item
        [node]="node"
        (edit)="openEditForm($event)"
        (delete)="deleteCategory($event)"
      />
    }
  </div>
</div>
